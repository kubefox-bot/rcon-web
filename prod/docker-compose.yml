services:
  # üß† –ë—ç–∫–µ–Ω–¥ ‚Äî –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç RCON-–∫–æ–º–∞–Ω–¥—ã –∏ –æ–±—â–∞–µ—Ç—Å—è —Å CS2-—Å–µ—Ä–≤–µ—Ä–æ–º
  rcon-back:
    image: ghcr.io/xymox72/rcon-backend:latest     # üì¶ –≥–æ—Ç–æ–≤—ã–π –æ–±—Ä–∞–∑ –±—ç–∫–µ–Ω–¥–∞
    container_name: rcon-back                      # –∏–º—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ (–º–æ–∂–Ω–æ –Ω–µ –º–µ–Ω—è—Ç—å)
    expose:
      - "3000"                                      # –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –ø–æ—Ä—Ç (–ø—Ä–æ–∫—Å–∏—Ä—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ nginx)
    env_file:
      - .env                                        # üîê –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–∑ .env (–Ω–∞–ø—Ä–∏–º–µ—Ä, ENCRYPTION_KEY)
    restart: unless-stopped                         # –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫, –µ—Å–ª–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —É–ø–∞–ª

  # üé® –§—Ä–æ–Ω—Ç–µ–Ω–¥ ‚Äî –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è RCON
  rcon-front:
    image: ghcr.io/xymox72/rcon-frontend:latest    # üì¶ –≥–æ—Ç–æ–≤—ã–π –æ–±—Ä–∞–∑ —Ñ—Ä–æ–Ω—Ç–∞
    container_name: rcon-front
    expose:
      - "4173"                                      # –ø–æ—Ä—Ç, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º —Ä–∞–±–æ—Ç–∞–µ—Ç —Ñ—Ä–æ–Ω—Ç –≤–Ω—É—Ç—Ä–∏ —Å–µ—Ç–∏
    env_file:
      - .env
    restart: unless-stopped

  # üåê Nginx ‚Äî –ø—Ä–æ–∫—Å–∏—Ä—É–µ—Ç —Ç—Ä–∞—Ñ–∏–∫ –∫ —Ñ—Ä–æ–Ω—Ç—É –∏ API
  nginx:
    image: nginx:1.27-alpine
    container_name: rcon-nginx
    ports:
      - "80:80"      # HTTP fallback
      - "3000:3000"   # üîì HTTP ‚Äî –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ (–º–æ–∂–Ω–æ –æ—Ç–∫–ª—é—á–∏—Ç—å)
      - "8443:8443"   # üîí HTTPS ‚Äî –æ—Å–Ω–æ–≤–Ω–æ–π –¥–æ—Å—Ç—É–ø –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
    volumes:
      - ./nginx/nginx.conf:/etc/nginx/nginx.conf:ro,z
      - ./certs:/etc/nginx/certs:ro,z
    depends_on:
      - rcon-back
      - rcon-front
    restart: unless-stopped
  cs2:
    image: joedwards32/cs2                              # üì¶ –≥–æ—Ç–æ–≤—ã–π –æ–±—Ä–∞–∑ CS2
    container_name: cs2                                 # üëà –∏–º—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
    restart: unless-stopped                             # üîÅ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏
    ports:
      - "27015:27015/tcp"                               # üì° –æ—Å–Ω–æ–≤–Ω–æ–π –ø–æ—Ä—Ç
      - "27015:27015/udp"
      - "27020:27020/udp"                               # üì∫ GOTV
      - "27050:27050/tcp"                               # üîê RCON
    volumes:
      - cs2-data:/home/steam/cs2-dedicated              # üíæ —Å–æ—Ö—Ä–∞–Ω—è–µ–º –≤—Å–µ –¥–∞–Ω–Ω—ã–µ —Å–µ—Ä–≤–µ—Ä–∞ –Ω–∞ –¥–∏—Å–∫
    env_file:
      - .env  

volumes:
  cs2-data:  # üíæ –•—Ä–∞–Ω–∏–º —Ñ–∞–π–ª—ã CS2 (–∫–∞—Ä—Ç—ã, –∫–æ–Ω—Ñ–∏–≥–∏, –ª–æ–≥–∏ –∏ —Ç.–ø.)
    driver: local
